@import "tailwindcss";

:root {
  /* Sommé 颂美 Brand Colors */
  --wine-deep: #8B2252;
  --wine-medium: #A83A6A;
  --wine-light: #C75B8E;
  --wine-cream: #FAF7F2;
  --wine-gold: #D4A56A;
  --wine-dark: #1E1A2B;
  --wine-text: #3D3A42;
  --wine-accent: #D4A56A;
  --wine-gold-warm: #D4A56A;
  --wine-green: #5B8C5A;
  --wine-secondary-text: #8A8690;
  --wine-border: #E8E5E0;
  --wine-card: #FFFFFF;
  --wine-bubble-text: #3D3A42;
  --wine-success: #3A9B7A;
  --wine-error: #D94F4F;
  --wine-warning: #E8B84B;
  --wine-info: #5B8FB9;
  /* Gradients */
  --gradient-tasting: linear-gradient(135deg, #8B2252 0%, #D4A56A 100%);
  --gradient-evening: linear-gradient(180deg, #4A1942 0%, #1E1A2B 100%);
  /* Dark-mode-aware functional tokens */
  --wine-hover-bg: rgba(114, 47, 55, 0.08);
  --wine-hover-bg-strong: rgba(114, 47, 55, 0.12);
  --wine-subtle-bg: rgba(114, 47, 55, 0.06);
  --wine-subtle-bg-lighter: rgba(114, 47, 55, 0.04);
  --wine-shadow: 0 1px 4px rgba(30, 26, 43, 0.06);
  --wine-shadow-md: 0 2px 8px rgba(139, 34, 82, 0.12);
  --wine-shadow-lg: 0 4px 16px rgba(139, 34, 82, 0.15);
  --wine-shadow-strong: 0 2px 8px rgba(139, 34, 82, 0.3);
  --wine-shadow-xl: 0 8px 40px rgba(139, 34, 82, 0.2);
  --wine-shadow-card: 0 2px 12px rgba(139, 34, 82, 0.06);
  --wine-overlay-bg: rgba(26, 10, 14, 0.4);
  --wine-overlay-bg-strong: rgba(26, 10, 14, 0.5);
  --wine-overlay-dark: rgba(0, 0, 0, 0.7);
  --wine-overlay-btn: rgba(0, 0, 0, 0.5);
  --wine-action-border: rgba(139, 34, 82, 0.1);
  --wine-action-bg: linear-gradient(135deg, rgba(114, 47, 55, 0.08), rgba(201, 169, 110, 0.12));
  --wine-action-border-color: rgba(114, 47, 55, 0.15);
  --wine-tag-bg: linear-gradient(135deg, rgba(114, 47, 55, 0.08), rgba(212, 165, 116, 0.12));
  --wine-tag-border: rgba(114, 47, 55, 0.12);
  --wine-tag-hover-bg: linear-gradient(135deg, rgba(114, 47, 55, 0.15), rgba(212, 165, 116, 0.2));
  --wine-tag-active-bg: linear-gradient(135deg, rgba(114, 47, 55, 0.22), rgba(212, 165, 116, 0.28));
  --wine-recommend-bg: rgba(255, 255, 255, 0.7);
  --wine-recommend-border: rgba(212, 165, 116, 0.3);
  --wine-quick-btn-bg: rgba(255, 255, 255, 0.6);
  --wine-empty-radial-1: rgba(114, 47, 55, 0.03);
  --wine-empty-radial-2: rgba(212, 165, 116, 0.04);
  --wine-glow-border: rgba(201, 169, 110, 0.6);
  --wine-glow-shadow: 0 0 20px rgba(201, 169, 110, 0.4), inset 0 0 20px rgba(201, 169, 110, 0.1);
  --wine-glow-shadow-pulse: 0 0 32px rgba(201, 169, 110, 0.6), inset 0 0 32px rgba(201, 169, 110, 0.2);
  --wine-skip-color: rgba(255, 255, 255, 0.8);
  --wine-skip-bg: rgba(255, 255, 255, 0.12);
  --wine-skip-border: rgba(255, 255, 255, 0.25);
  --wine-card-overlay-shadow: 0 16px 64px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.1);
  --wine-img-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  --wine-lightbox-shadow: 0 8px 40px rgba(0, 0, 0, 0.4);
  --wine-rating-low: #999;
  --wine-rating-mid: #C9A96E;
  --wine-rating-high: #8B2252;
  --wine-disabled-bg: rgba(114, 47, 55, 0.04);
  --wine-disabled-border: rgba(114, 47, 55, 0.08);
  --wine-cellar-card-border: rgba(114, 47, 55, 0.06);
  /* iOS safe area */
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
  /* App height — fallback for iOS Safari 100vh bug */
  --app-height: 100vh;
}

@supports (height: 100dvh) {
  :root {
    --app-height: 100dvh;
  }
}

body {
  background: var(--wine-cream);
  color: var(--wine-text);
  font-family: 'Inter', 'Noto Sans SC', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  -webkit-text-size-adjust: 100%;
}

/* Dark mode — .dark class (primary, set by JS in layout.tsx) */
.dark {
  --wine-deep: #C75B8E;
  --wine-medium: #A83A6A;
  --wine-cream: #1E1A2B;
  --wine-dark: #14111E;
  --wine-text: #F0EDE8;
  --wine-secondary-text: #6B6774;
  --wine-border: #3A3548;
  --wine-card: #2A2636;
  --wine-bubble-text: #F0EDE8;
  --wine-gold: #E0BA80;
  --wine-accent: #E0BA80;
  --wine-gold-warm: #E0BA80;
  /* Dark functional tokens */
  --wine-hover-bg: rgba(199, 91, 142, 0.12);
  --wine-hover-bg-strong: rgba(199, 91, 142, 0.18);
  --wine-subtle-bg: rgba(199, 91, 142, 0.10);
  --wine-subtle-bg-lighter: rgba(199, 91, 142, 0.06);
  --wine-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);
  --wine-shadow-md: 0 2px 8px rgba(0, 0, 0, 0.35);
  --wine-shadow-lg: 0 4px 16px rgba(0, 0, 0, 0.4);
  --wine-shadow-strong: 0 2px 8px rgba(0, 0, 0, 0.5);
  --wine-shadow-xl: 0 8px 40px rgba(0, 0, 0, 0.5);
  --wine-shadow-card: 0 2px 12px rgba(0, 0, 0, 0.3);
  --wine-overlay-bg: rgba(0, 0, 0, 0.6);
  --wine-overlay-bg-strong: rgba(0, 0, 0, 0.7);
  --wine-overlay-dark: rgba(0, 0, 0, 0.85);
  --wine-overlay-btn: rgba(0, 0, 0, 0.6);
  --wine-action-border: rgba(199, 91, 142, 0.15);
  --wine-action-bg: linear-gradient(135deg, rgba(199, 91, 142, 0.12), rgba(224, 186, 128, 0.15));
  --wine-action-border-color: rgba(199, 91, 142, 0.2);
  --wine-tag-bg: linear-gradient(135deg, rgba(199, 91, 142, 0.12), rgba(224, 186, 128, 0.15));
  --wine-tag-border: rgba(199, 91, 142, 0.18);
  --wine-tag-hover-bg: linear-gradient(135deg, rgba(199, 91, 142, 0.2), rgba(224, 186, 128, 0.25));
  --wine-tag-active-bg: linear-gradient(135deg, rgba(199, 91, 142, 0.3), rgba(224, 186, 128, 0.35));
  --wine-recommend-bg: rgba(42, 38, 54, 0.8);
  --wine-recommend-border: rgba(224, 186, 128, 0.3);
  --wine-quick-btn-bg: rgba(42, 38, 54, 0.7);
  --wine-empty-radial-1: rgba(199, 91, 142, 0.06);
  --wine-empty-radial-2: rgba(224, 186, 128, 0.06);
  --wine-glow-border: rgba(224, 186, 128, 0.5);
  --wine-glow-shadow: 0 0 20px rgba(224, 186, 128, 0.3), inset 0 0 20px rgba(224, 186, 128, 0.08);
  --wine-glow-shadow-pulse: 0 0 32px rgba(224, 186, 128, 0.5), inset 0 0 32px rgba(224, 186, 128, 0.15);
  --wine-skip-color: rgba(255, 255, 255, 0.8);
  --wine-skip-bg: rgba(255, 255, 255, 0.1);
  --wine-skip-border: rgba(255, 255, 255, 0.2);
  --wine-card-overlay-shadow: 0 16px 64px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.05);
  --wine-img-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  --wine-lightbox-shadow: 0 8px 40px rgba(0, 0, 0, 0.6);
  --wine-rating-low: #8A8690;
  --wine-rating-mid: #E0BA80;
  --wine-rating-high: #C75B8E;
  --wine-disabled-bg: rgba(199, 91, 142, 0.06);
  --wine-disabled-border: rgba(199, 91, 142, 0.1);
  --wine-cellar-card-border: rgba(199, 91, 142, 0.1);
}

/* Dark mode — @media fallback (when no .dark or .light class is set) */
@media (prefers-color-scheme: dark) {
  :root:not(.light):not(.dark) {
    --wine-deep: #C75B8E;
    --wine-medium: #A83A6A;
    --wine-cream: #1E1A2B;
    --wine-dark: #14111E;
    --wine-text: #F0EDE8;
    --wine-secondary-text: #6B6774;
    --wine-border: #3A3548;
    --wine-card: #2A2636;
    --wine-bubble-text: #F0EDE8;
    --wine-gold: #E0BA80;
    --wine-accent: #E0BA80;
    --wine-gold-warm: #E0BA80;
    /* Dark functional tokens */
    --wine-hover-bg: rgba(199, 91, 142, 0.12);
    --wine-hover-bg-strong: rgba(199, 91, 142, 0.18);
    --wine-subtle-bg: rgba(199, 91, 142, 0.10);
    --wine-subtle-bg-lighter: rgba(199, 91, 142, 0.06);
    --wine-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);
    --wine-shadow-md: 0 2px 8px rgba(0, 0, 0, 0.35);
    --wine-shadow-lg: 0 4px 16px rgba(0, 0, 0, 0.4);
    --wine-shadow-strong: 0 2px 8px rgba(0, 0, 0, 0.5);
    --wine-shadow-xl: 0 8px 40px rgba(0, 0, 0, 0.5);
    --wine-shadow-card: 0 2px 12px rgba(0, 0, 0, 0.3);
    --wine-overlay-bg: rgba(0, 0, 0, 0.6);
    --wine-overlay-bg-strong: rgba(0, 0, 0, 0.7);
    --wine-overlay-dark: rgba(0, 0, 0, 0.85);
    --wine-overlay-btn: rgba(0, 0, 0, 0.6);
    --wine-action-border: rgba(199, 91, 142, 0.15);
    --wine-action-bg: linear-gradient(135deg, rgba(199, 91, 142, 0.12), rgba(224, 186, 128, 0.15));
    --wine-action-border-color: rgba(199, 91, 142, 0.2);
    --wine-tag-bg: linear-gradient(135deg, rgba(199, 91, 142, 0.12), rgba(224, 186, 128, 0.15));
    --wine-tag-border: rgba(199, 91, 142, 0.18);
    --wine-tag-hover-bg: linear-gradient(135deg, rgba(199, 91, 142, 0.2), rgba(224, 186, 128, 0.25));
    --wine-tag-active-bg: linear-gradient(135deg, rgba(199, 91, 142, 0.3), rgba(224, 186, 128, 0.35));
    --wine-recommend-bg: rgba(42, 38, 54, 0.8);
    --wine-recommend-border: rgba(224, 186, 128, 0.3);
    --wine-quick-btn-bg: rgba(42, 38, 54, 0.7);
    --wine-empty-radial-1: rgba(199, 91, 142, 0.06);
    --wine-empty-radial-2: rgba(224, 186, 128, 0.06);
    --wine-glow-border: rgba(224, 186, 128, 0.5);
    --wine-glow-shadow: 0 0 20px rgba(224, 186, 128, 0.3), inset 0 0 20px rgba(224, 186, 128, 0.08);
    --wine-glow-shadow-pulse: 0 0 32px rgba(224, 186, 128, 0.5), inset 0 0 32px rgba(224, 186, 128, 0.15);
    --wine-skip-color: rgba(255, 255, 255, 0.8);
    --wine-skip-bg: rgba(255, 255, 255, 0.1);
    --wine-skip-border: rgba(255, 255, 255, 0.2);
    --wine-card-overlay-shadow: 0 16px 64px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.05);
    --wine-img-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
    --wine-lightbox-shadow: 0 8px 40px rgba(0, 0, 0, 0.6);
    --wine-rating-low: #8A8690;
    --wine-rating-mid: #E0BA80;
    --wine-rating-high: #C75B8E;
    --wine-disabled-bg: rgba(199, 91, 142, 0.06);
    --wine-disabled-border: rgba(199, 91, 142, 0.1);
    --wine-cellar-card-border: rgba(199, 91, 142, 0.1);
  }
}

/* ═══ Custom scrollbar — thin, wine-themed ═══ */
::-webkit-scrollbar {
  width: 4px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, var(--wine-deep), var(--wine-medium));
  border-radius: 2px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--wine-deep);
}

/* Firefox scrollbar */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--wine-deep) transparent;
}

/* ═══ Streaming text cursor blink ═══ */
@keyframes blink {
  0%, 50% { opacity: 1; }
  51%, 100% { opacity: 0; }
}

.cursor-blink::after {
  content: '▋';
  animation: blink 0.8s step-end infinite;
  color: var(--wine-deep);
  font-size: 0.85em;
  margin-left: 1px;
  vertical-align: baseline;
}

/* ═══ Message slide-up + fade-in ═══ */
@keyframes messageSlideIn {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.message-enter {
  animation: messageSlideIn 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
}

/* ═══ Message bubble hover lift ═══ */
.msg-bubble {
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.msg-bubble:hover {
  transform: translateY(-1px);
  box-shadow: var(--wine-shadow-md);
}

/* ═══ Header animations ═══ */
@keyframes headerFadeIn {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.header-animate {
  animation: headerFadeIn 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
}

/* Header bottom decorative gradient */
.header-decorated {
  position: relative;
}

.header-decorated::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 10%;
  right: 10%;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--wine-accent), var(--wine-gold-warm), var(--wine-accent), transparent);
}

/* ═══ Welcome area animations ═══ */
@keyframes welcomeFadeIn {
  from {
    opacity: 0;
    transform: translateY(16px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.welcome-animate {
  animation: welcomeFadeIn 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.15s both;
}

/* ═══ Empty state → Chat state transitions ═══ */
@keyframes fadeOutSlideUp {
  from {
    opacity: 1;
    transform: translateY(0);
  }
  to {
    opacity: 0;
    transform: translateY(-20px);
  }
}

.fade-out-up {
  animation: fadeOutSlideUp 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
}

@keyframes fadeInFromBelow {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.fade-in-up {
  animation: fadeInFromBelow 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.1s both;
}

/* ═══ Quick button refined styles ═══ */
.quick-btn {
  position: relative;
  overflow: hidden;
  transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  background: var(--wine-quick-btn-bg);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

.quick-btn::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, var(--wine-deep), var(--wine-medium));
  opacity: 0;
  transition: opacity 0.3s ease;
  border-radius: inherit;
}

.quick-btn:hover {
  transform: scale(1.03);
  box-shadow: var(--wine-shadow-lg);
  border-color: var(--wine-deep) !important;
}

.quick-btn:hover::before {
  opacity: 1;
}

.quick-btn:hover .quick-btn-content {
  color: white !important;
  position: relative;
  z-index: 1;
}

.quick-btn:active {
  transform: scale(0.95) !important;
}

.quick-btn .quick-btn-content {
  position: relative;
  z-index: 1;
  transition: color 0.3s ease;
}

/* ═══ AI avatar breathing/pulse animation ═══ */
@keyframes breathe {
  0%, 100% {
    box-shadow: 0 0 0 0 var(--wine-hover-bg);
    transform: scale(1);
  }
  50% {
    box-shadow: 0 0 0 6px transparent;
    transform: scale(1.05);
  }
}

.ai-avatar-pulse {
  animation: breathe 2s ease-in-out infinite;
}

/* ═══ Send button micro-interactions ═══ */
@keyframes sendFly {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(0.85) translateX(2px);
    opacity: 0.7;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.send-btn {
  transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.send-btn:active:not(:disabled) {
  transform: scale(0.85) !important;
}

.send-btn-fly {
  animation: sendFly 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

/* ═══ Input focus glow ═══ */
.input-container {
  transition: all 0.3s ease;
  border: 1px solid var(--wine-light);
}

.input-container:focus-within {
  border-color: var(--wine-deep);
  box-shadow:
    0 0 0 3px var(--wine-hover-bg),
    0 0 20px var(--wine-subtle-bg);
}

/* ═══ Wine glass swirl loading animation ═══ */
@keyframes swirl {
  0% { transform: rotate(0deg); }
  15% { transform: rotate(12deg); }
  30% { transform: rotate(-10deg); }
  45% { transform: rotate(8deg); }
  60% { transform: rotate(-6deg); }
  75% { transform: rotate(4deg); }
  90% { transform: rotate(-2deg); }
  100% { transform: rotate(0deg); }
}

@keyframes wineWave {
  0%, 100% { transform: translateY(0) scaleY(1); }
  25% { transform: translateY(-2px) scaleY(0.95); }
  50% { transform: translateY(1px) scaleY(1.02); }
  75% { transform: translateY(-1px) scaleY(0.98); }
}

@keyframes shimmer {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 1; }
}

.wine-glass-loader {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  animation: swirl 2s ease-in-out infinite;
}

.wine-glass-loader .glass-bowl {
  width: 28px;
  height: 18px;
  border: 2px solid var(--wine-deep);
  border-top: none;
  border-radius: 0 0 14px 14px;
  position: relative;
  overflow: hidden;
}

.wine-glass-loader .wine-fill {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 60%;
  background: linear-gradient(135deg, var(--wine-deep), var(--wine-medium));
  border-radius: 0 0 12px 12px;
  animation: wineWave 2s ease-in-out infinite;
}

.wine-glass-loader .glass-stem {
  width: 2px;
  height: 10px;
  background: var(--wine-deep);
}

.wine-glass-loader .glass-base {
  width: 16px;
  height: 2px;
  background: var(--wine-deep);
  border-radius: 1px;
}

.wine-glass-loader .shimmer-text {
  font-size: 11px;
  color: var(--wine-medium);
  font-family: 'Noto Serif SC', serif;
  margin-top: 4px;
  animation: shimmer 2s ease-in-out infinite;
}

/* ═══ Scroll to bottom button ═══ */
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

.scroll-to-bottom-btn {
  animation: fadeInUp 0.25s ease-out;
}

/* ═══ Decorative elements — vine/wine motifs ═══ */
.wine-decoration {
  position: relative;
}

.wine-decoration::before {
  content: '';
  position: absolute;
  top: -30px;
  left: 50%;
  transform: translateX(-50%);
  width: 120px;
  height: 60px;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 120 60' fill='none'%3E%3Cpath d='M20 40 C30 10, 50 10, 60 30 C70 10, 90 10, 100 40' stroke='%23D4A574' stroke-width='1' opacity='0.3' fill='none'/%3E%3Ccircle cx='35' cy='20' r='3' fill='%23D4A574' opacity='0.15'/%3E%3Ccircle cx='85' cy='20' r='3' fill='%23D4A574' opacity='0.15'/%3E%3Ccircle cx='60' cy='35' r='4' fill='%23D4A574' opacity='0.1'/%3E%3C/svg%3E") no-repeat center;
  opacity: 0.5;
  pointer-events: none;
}

/* Empty state decorative background */
.empty-state-bg {
  position: relative;
}

.empty-state-bg::before {
  content: '';
  position: absolute;
  inset: 0;
  background:
    radial-gradient(ellipse 600px 400px at 20% 50%, var(--wine-empty-radial-1) 0%, transparent 70%),
    radial-gradient(ellipse 600px 400px at 80% 50%, var(--wine-empty-radial-2) 0%, transparent 70%);
  pointer-events: none;
}

/* Wine bottle silhouette decorative element */
.wine-bottle-decor {
  position: absolute;
  opacity: 0.04;
  pointer-events: none;
}

/* ═══ Taste profile tag styles ═══ */
@keyframes tagFadeIn {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.taste-tag {
  display: inline-flex;
  align-items: center;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-family: 'Noto Serif SC', serif;
  background: var(--wine-tag-bg);
  color: var(--wine-deep);
  border: 1px solid var(--wine-tag-border);
  transition: all 0.25s ease;
  animation: tagFadeIn 0.3s ease both;
}

.taste-tag:hover,
.taste-tag-clickable:hover {
  background: var(--wine-tag-hover-bg);
  transform: translateY(-1px);
  box-shadow: var(--wine-shadow-md);
}

.taste-tag-clickable {
  cursor: pointer;
  border: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.taste-tag-clickable:active {
  transform: scale(0.95);
  background: var(--wine-tag-active-bg);
  box-shadow: var(--wine-shadow);
}

/* Taste section recommend button */
.taste-recommend-btn {
  position: relative;
  overflow: hidden;
  padding: 8px 16px;
  border-radius: 12px;
  font-size: 13px;
  font-family: 'Noto Serif SC', serif;
  color: var(--wine-deep);
  background: var(--wine-recommend-bg);
  border: 1px solid var(--wine-recommend-border);
  transition: all 0.3s ease;
  cursor: pointer;
  backdrop-filter: blur(4px);
}

.taste-recommend-btn::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, var(--wine-accent), var(--wine-gold-warm));
  opacity: 0;
  transition: opacity 0.3s ease;
  border-radius: inherit;
}

.taste-recommend-btn:hover {
  transform: scale(1.03);
  box-shadow: var(--wine-shadow-lg);
  border-color: var(--wine-gold-warm);
}

.taste-recommend-btn:hover::before {
  opacity: 1;
}

.taste-recommend-btn:hover .taste-recommend-text {
  color: white;
}

.taste-recommend-btn:active {
  transform: scale(0.96);
}

.taste-recommend-text {
  position: relative;
  z-index: 1;
  transition: color 0.3s ease;
}

/* ═══ Taste profile section ═══ */
.taste-section {
  animation: welcomeFadeIn 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.3s both;
}

/* ═══ Footer decorative line ═══ */
.footer-decorated {
  position: relative;
}

.footer-decorated::before {
  content: '';
  position: absolute;
  top: 0;
  left: 15%;
  right: 15%;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--wine-accent) 30%, var(--wine-gold-warm) 50%, var(--wine-accent) 70%, transparent);
}

/* ═══ Decorative divider ═══ */
.wine-divider {
  display: flex;
  align-items: center;
  gap: 12px;
  margin: 16px 0;
}

.wine-divider::before,
.wine-divider::after {
  content: '';
  flex: 1;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--wine-accent), transparent);
}

/* ═══ Wine hover background utility ═══ */
.wine-hover-bg:hover {
  background-color: var(--wine-hover-bg);
}

/* ═══ Touch feedback for mobile ═══ */
@media (hover: none) and (pointer: coarse) {
  button:active {
    opacity: 0.7;
    transform: scale(0.97);
    transition: transform 0.1s, opacity 0.1s;
  }

  .msg-bubble:hover {
    transform: none;
    box-shadow: none;
  }
}

/* ═══ Mobile font size adjustments ═══ */
@media (max-width: 640px) {
  body {
    font-size: 16px;
  }
}

/* ═══ Confirm dialog overlay ═══ */
@keyframes overlayFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes dialogSlideUp {
  from { opacity: 0; transform: translate(-50%, -50%) scale(0.95); }
  to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
}

.confirm-overlay {
  animation: overlayFadeIn 0.2s ease-out;
}

.confirm-dialog {
  animation: dialogSlideUp 0.2s ease-out;
}

/* ═══ Error message retry button ═══ */
.retry-btn {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  margin-top: 8px;
  padding: 4px 12px;
  border-radius: 8px;
  font-size: 12px;
  border: 1px solid var(--wine-light);
  color: var(--wine-deep);
  background: var(--wine-cream);
  cursor: pointer;
  transition: all 0.2s;
  font-family: 'Noto Serif SC', serif;
}

.retry-btn:hover {
  background: var(--wine-deep);
  color: white;
  border-color: var(--wine-deep);
}

/* ═══ Empty state large wine icon animation ═══ */
@keyframes gentleFloat {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-6px);
  }
}

.wine-icon-float {
  animation: gentleFloat 3s ease-in-out infinite;
  display: inline-block;
}

/* ═══ Stagger animations for quick buttons ═══ */
.stagger-1 { animation-delay: 0.05s; }
.stagger-2 { animation-delay: 0.1s; }
.stagger-3 { animation-delay: 0.15s; }
.stagger-4 { animation-delay: 0.2s; }

@keyframes quickBtnEnter {
  from {
    opacity: 0;
    transform: translateY(10px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.quick-btn-animate {
  animation: quickBtnEnter 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
}

/* ═══ Action Sheet (bottom slide-up) ═══ */
@keyframes actionSheetOverlayIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes actionSheetSlideUp {
  from { transform: translateY(100%); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

.action-sheet-overlay {
  background-color: var(--wine-overlay-bg);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  animation: actionSheetOverlayIn 0.2s ease-out;
}

.action-sheet-content {
  animation: actionSheetSlideUp 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.action-sheet-card {
  box-shadow: var(--wine-shadow-md);
}

.action-sheet-btn:active {
  background-color: var(--wine-subtle-bg) !important;
}

/* ═══ Image preview bar ═══ */
@keyframes imagePreviewIn {
  from { opacity: 0; transform: scale(0.85) translateY(8px); }
  to { opacity: 1; transform: scale(1) translateY(0); }
}

.image-preview-bar {
  animation: imagePreviewIn 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.image-preview-container {
  transition: all 0.2s ease;
}

.image-preview-container:hover {
  transform: scale(1.05);
}

.image-preview-remove {
  transition: all 0.2s ease;
}

.image-preview-remove:hover {
  transform: scale(1.15);
  background-color: var(--wine-medium) !important;
}

/* ═══ Image loading spinner ═══ */
@keyframes imageSpinner {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.image-loading-spinner {
  width: 16px;
  height: 16px;
  border: 2px solid var(--wine-light);
  border-top-color: var(--wine-deep);
  border-radius: 50%;
  animation: imageSpinner 0.8s linear infinite;
}

/* ═══ Camera button ═══ */
.camera-btn {
  transition: all 0.25s ease;
}

.camera-btn:active:not(:disabled) {
  transform: scale(0.88) !important;
}

.camera-btn:hover:not(:disabled) {
  border-color: var(--wine-deep) !important;
  background-color: var(--wine-subtle-bg) !important;
}

/* ═══ Lightbox ═══ */
@keyframes lightboxOverlayIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes lightboxImageIn {
  from { opacity: 0; transform: scale(0.9); }
  to { opacity: 1; transform: scale(1); }
}

.lightbox-overlay {
  background-color: var(--wine-overlay-dark);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  animation: lightboxOverlayIn 0.25s ease-out;
}

.lightbox-image {
  animation: lightboxImageIn 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

/* ═══ Chat image thumbnail ═══ */
.chat-image-thumb {
  transition: all 0.25s ease;
}

.chat-image-thumb:hover {
  transform: scale(1.03);
  box-shadow: var(--wine-shadow-lg) !important;
}

.chat-image-thumb:active {
  transform: scale(0.97);
}

/* ═══ v0.5: Message Action Buttons ═══ */
.msg-action-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 16px;
  border-radius: 12px;
  font-size: 13px;
  font-family: 'Noto Serif SC', serif;
  background: var(--wine-action-bg);
  border: 1px solid var(--wine-action-border-color);
  color: var(--wine-deep);
  cursor: pointer;
  transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  position: relative;
  overflow: hidden;
}

.msg-action-btn::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, var(--wine-deep), var(--wine-medium));
  opacity: 0;
  transition: opacity 0.25s ease;
  border-radius: inherit;
}

.msg-action-btn:not(:disabled):hover {
  transform: translateY(-1px);
  box-shadow: var(--wine-shadow-lg);
  border-color: var(--wine-deep);
}

.msg-action-btn:not(:disabled):hover::before {
  opacity: 1;
}

.msg-action-btn:not(:disabled):hover .msg-action-icon,
.msg-action-btn:not(:disabled):hover .msg-action-label {
  color: white;
  position: relative;
  z-index: 1;
}

.msg-action-btn:not(:disabled):active {
  transform: scale(0.95);
}

.msg-action-btn:disabled {
  opacity: 0.45;
  cursor: default;
  background: var(--wine-disabled-bg);
  border-color: var(--wine-disabled-border);
}

.msg-action-icon {
  font-size: 15px;
  position: relative;
  z-index: 1;
}

.msg-action-label {
  font-weight: 500;
  position: relative;
  z-index: 1;
}

/* ═══ v0.5: Rating Modal ═══ */
@keyframes ratingOverlayIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes ratingModalSlideUp {
  from { opacity: 0; transform: translateY(100%); }
  to { opacity: 1; transform: translateY(0); }
}

.rating-overlay {
  background-color: var(--wine-overlay-bg-strong);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  animation: ratingOverlayIn 0.2s ease-out;
}

.rating-modal {
  animation: ratingModalSlideUp 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  box-shadow: var(--wine-shadow-xl);
}

/* Custom range slider */
.rating-slider {
  -webkit-appearance: none;
  appearance: none;
  height: 6px;
  border-radius: 3px;
  background: linear-gradient(90deg, var(--wine-rating-low) 0%, var(--wine-gold-warm) 50%, var(--wine-deep) 100%);
  outline: none;
}

.rating-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: white;
  border: 3px solid var(--wine-deep);
  box-shadow: var(--wine-shadow-strong);
  cursor: pointer;
  transition: transform 0.15s ease;
}

.rating-slider::-webkit-slider-thumb:active {
  transform: scale(1.2);
}

.rating-slider::-moz-range-thumb {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: white;
  border: 3px solid var(--wine-deep);
  box-shadow: var(--wine-shadow-strong);
  cursor: pointer;
}

/* ═══ v0.5: Toast ═══ */
@keyframes toastIn {
  from { opacity: 0; transform: translateX(-50%) translateY(-12px); }
  to { opacity: 1; transform: translateX(-50%) translateY(0); }
}

@keyframes toastOut {
  from { opacity: 1; }
  to { opacity: 0; }
}

.toast-container {
  animation: toastIn 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.toast-card {
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}

/* ═══ v0.5: Cellar Page ═══ */
@keyframes cellarSlideIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.cellar-page {
  animation: cellarSlideIn 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  display: flex;
  flex-direction: column;
}

.cellar-header {
  position: relative;
}

.cellar-header::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 10%;
  right: 10%;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--wine-accent), var(--wine-gold-warm), var(--wine-accent), transparent);
}

/* Cellar tabs */
.cellar-tabs {
  padding: 4px;
}

/* Cellar card */
.cellar-card {
  transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.cellar-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--wine-shadow-lg) !important;
}

.cellar-card:active {
  transform: scale(0.98);
}

/* Cellar rating badge */
.cellar-rating-badge {
  min-width: 32px;
  text-align: center;
  font-family: 'Cormorant Garamond', serif;
  letter-spacing: 0.5px;
}

/* Line clamp utility */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* ═══ Scenario Cards ═══ */
.scenario-card {
  position: relative;
  overflow: hidden;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
}

.scenario-card::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, var(--wine-deep), var(--wine-medium));
  opacity: 0;
  transition: opacity 0.3s ease;
  border-radius: inherit;
}

.scenario-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--wine-shadow-lg);
  border-color: var(--wine-deep) !important;
}

.scenario-card:hover::before {
  opacity: 1;
}

.scenario-card:hover span {
  color: white !important;
  position: relative;
  z-index: 1;
}

.scenario-card:active {
  transform: scale(0.96) !important;
}

/* Quick chips (small pill buttons) */
.quick-chip {
  transition: all 0.2s ease;
  animation: quickBtnEnter 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
}

.quick-chip:hover {
  background: var(--wine-deep) !important;
  color: white !important;
  border-color: var(--wine-deep) !important;
  transform: scale(1.05);
}

.quick-chip:active {
  transform: scale(0.93) !important;
}

/* ═══ Route Choice Card (smart routing buttons in AI message) ═══ */
.route-choice-card {
  animation: messageSlideIn 0.3s ease-out;
}

.route-choice-btn {
  transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.route-choice-btn:hover:not(:disabled) {
  background-color: var(--wine-hover-bg-strong) !important;
  border-color: var(--wine-deep) !important;
  transform: translateX(2px);
  box-shadow: var(--wine-shadow-md);
}

.route-choice-btn:active:not(:disabled) {
  transform: scale(0.97) !important;
}

/* ═══ Wine Cellar Page ═══ */
@keyframes cellarSlideIn {
  from { opacity: 0; transform: translateX(100%); }
  to { opacity: 1; transform: translateX(0); }
}

.cellar-page {
  animation: cellarSlideIn 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

/* Cellar card hover */
.cellar-card {
  transition: all 0.25s ease;
}

.cellar-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--wine-shadow-lg) !important;
}

.cellar-card:active {
  transform: scale(0.98);
}

/* Cellar rating badge */
.cellar-rating {
  min-width: 28px;
  text-align: center;
  box-shadow: var(--wine-shadow);
}

/* Line clamp utility */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* ═══ Wine Detail View ═══ */
@keyframes detailSlideUp {
  from { opacity: 0; transform: translateY(100%); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes detailSlideDown {
  from { opacity: 1; transform: translateY(0); }
  to { opacity: 0; transform: translateY(100%); }
}

.wine-detail-slide-up {
  animation: detailSlideUp 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}

.wine-detail-slide-down {
  animation: detailSlideDown 0.3s cubic-bezier(0.55, 0.085, 0.68, 0.53) forwards;
}

/* Tasting tag chips in RatingModal */
.tasting-chip {
  transition: all 0.2s ease;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

.tasting-chip:hover {
  transform: translateY(-1px);
  box-shadow: var(--wine-shadow-md);
}

/* ═══ Onboarding Tour ═══ */
@keyframes onboardingCardEnterNext {
  from {
    opacity: 0;
    transform: translateX(-50%) translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
}

@keyframes onboardingCardEnterCenter {
  from {
    opacity: 0;
    transform: translate(-50%, 50%) scale(0.92);
  }
  to {
    opacity: 1;
    transform: translate(-50%, 50%) scale(1);
  }
}

@keyframes onboardingIconBounce {
  0% { transform: scale(0.6) rotate(-8deg); opacity: 0; }
  50% { transform: scale(1.1) rotate(4deg); opacity: 1; }
  100% { transform: scale(1) rotate(0deg); opacity: 1; }
}

.onboarding-card-enter-next {
  animation: onboardingCardEnterNext 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
}

/* For centered cards (step 1 with no spotlight) use the center animation */
.onboarding-card-enter-next[style*="translate(-50%, 50%)"] {
  animation: onboardingCardEnterCenter 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
}

.onboarding-card-enter-prev {
  animation: onboardingCardEnterNext 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
}

.onboarding-icon-bounce {
  animation: onboardingIconBounce 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 0.15s both;
}

@keyframes onboarding-glow-pulse {
  0%, 100% { opacity: 1; box-shadow: var(--wine-glow-shadow); }
  50% { opacity: 0.6; box-shadow: var(--wine-glow-shadow-pulse); }
}

.onboarding-cta-btn:hover {
  transform: scale(1.02);
  box-shadow: var(--wine-shadow-xl) !important;
}

.onboarding-cta-btn:active {
  transform: scale(0.97) !important;
}

.onboarding-skip-btn:hover {
  color: rgba(255, 255, 255, 0.95) !important;
  background: rgba(255, 255, 255, 0.18) !important;
  border-color: rgba(255, 255, 255, 0.4) !important;
}
